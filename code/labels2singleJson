import os
import json

def extract_labels_from_json(folder_path):
    label_dict = {}

    # Iterate over each JSON file in the folder
    for filename in os.listdir(folder_path):
        if filename.endswith(".json"):
            file_path = os.path.join(folder_path, filename)

            # Read JSON data from the file
            with open(file_path, 'r') as file:
                json_data = json.load(file)

            # Extract required fields from JSON data
            video_name = json_data["video"]["video_name"]
            labels = []

            # Check each label field and add label if value is 1
            for key, value in json_data["video"].items():
                if value == 1:
                    labels.append(key)
                elif isinstance(value, int) and value != 0:
                    labels.append(f"{key}_{value}")

            # Add labels to the dictionary if there are any
            if labels:
                label_dict[video_name] = labels

    return label_dict

def save_labels_to_json(label_dict, output_file):
    # Write the label dictionary to a new JSON file
    with open(output_file, 'w') as file:
        json.dump(label_dict, file, indent=4)

# Folder containing JSON files
folder_path = "C:/Users/skku/Desktop/New folder/label/label"

# Extract labels from JSON files
label_dict = extract_labels_from_json(folder_path)

# Output file to save the label dictionary
output_file = "labels.json"

# Save the label dictionary to a new JSON file
save_labels_to_json(label_dict, output_file)
